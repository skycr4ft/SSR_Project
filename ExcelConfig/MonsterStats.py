import xlwings as xw



class Mon_Numerical():
    def __init__(self):
        self.hero_level_attr = {'blue': {
            'atk': [15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 53, 56, 59, 62, 65,
                    68,
                    71, 74, 77, 80, 83, 86, 89, 92, 95, 98, 101, 104, 107, 110, 113],
            'def': [15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 53, 56, 59, 62, 65,
                    68,
                    71, 74, 77, 80, 83, 86, 89, 92, 95, 98, 101, 104, 107, 110, 113],
            'hp': [125, 141, 158, 175, 191, 208, 225, 241, 258, 275, 291, 308, 325, 341, 358, 375, 391, 408, 425,
                   441,
                   466, 491, 516, 541, 566, 591, 616, 641, 666, 691, 716, 741, 766, 791, 816, 841, 866, 891, 916,
                   941]},
            'purple': {
                'atk': [24, 26, 28, 30, 33, 35, 37, 40, 42, 44, 47, 49, 52, 54, 57, 60, 62, 65, 67, 70, 74, 78, 82,
                        86, 90,
                        94, 98, 102, 106, 110, 114, 118, 122, 126, 130, 134, 138, 142, 146, 150],
                'def': [24, 26, 28, 30, 33, 35, 37, 40, 42, 44, 47, 49, 52, 54, 57, 60, 62, 65, 67, 70, 74, 78, 82,
                        86, 90,
                        94, 98, 102, 106, 110, 114, 118, 122, 126, 130, 134, 138, 142, 146, 150],
                'hp': [200, 216, 234, 255, 275, 295, 314, 333, 353, 374, 393, 416, 438, 457, 480, 502, 520, 543,
                       565, 587,
                       620, 653, 687, 720, 753, 786, 820, 853, 886, 919, 953, 986, 1019, 1052, 1086, 1119, 1152,
                       1185,
                       1219, 1252]},
            'orange': {
                'atk': [33, 35, 38, 41, 45, 48, 51, 55, 58, 61, 65, 68, 71, 75, 78, 81, 85, 89, 92, 95, 101, 106,
                        111, 117,
                        122, 127, 133, 138, 144, 149, 154, 160, 165, 171, 176, 181, 187, 192, 198, 203],
                'def': [33, 35, 38, 41, 45, 48, 51, 55, 58, 61, 65, 68, 71, 75, 78, 81, 85, 89, 92, 95, 101, 106,
                        111, 117,
                        122, 127, 133, 138, 144, 149, 154, 160, 165, 171, 176, 181, 187, 192, 198, 203],
                'hp': [275, 297, 319, 346, 375, 404, 432, 459, 485, 514, 542, 570, 598, 625, 652, 682, 712, 743,
                       769, 799,
                       844, 889, 930, 975, 1020, 1065, 1110, 1155, 1200, 1245, 1290, 1335, 1380, 1425, 1470, 1515,
                       1560,
                       1605, 1650, 1695]}}
        self.monster_offset = {'白板': {'name': '白板', 'quality': 1.0, 'atk': 1.0, 'def': 1.0, 'hp': 1.0}}

    def calc_monster_attr(self, hero, level, quality):
        atk = self.monster_offset[hero]['atk'] * self.hero_level_attr[quality]['atk'][level - 1]

        _def = self.monster_offset[hero]['def'] * self.hero_level_attr[quality]['def'][level - 1]

        hp = self.monster_offset[hero]['hp'] * self.hero_level_attr[quality]['hp'][level - 1]

        return [atk, _def, hp, 0, 0, 0, 0, hero, level]

    def pack(self, monster_info):
        attrs = self.calc_monster_attr(**monster_info)
        dict = {}
        dict['atk_base'], dict['def_base'], dict['max_hp_base'], dict['crit_base'], dict['crit_res_base'], \
            dict['eff_hit_base'], dict['eff_res_base'] = \
            attrs[0], attrs[1], attrs[2], attrs[3], attrs[4], attrs[5], attrs[6]
        dict['name'], dict['level'] = attrs[7], attrs[8]
        return dict
